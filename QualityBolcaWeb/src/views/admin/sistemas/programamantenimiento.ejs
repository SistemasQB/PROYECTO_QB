<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Programa de Mantenimiento de Equipo de Cómputo</title>
    <!-- <link rel="stylesheet" href="styles.css"> -->
</head>

<style>
  * {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: Arial, sans-serif;
  background-color: #f5f5f5;
  padding: 20px;
}

.container {
  max-width: 1400px;
  margin: 0 auto;
  background-color: white;
  padding: 20px;
  box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
}

/* Header Styles */
.header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  margin-bottom: 30px;
  gap: 20px;
}

.logo-section {
  flex-shrink: 0;
}

.logo-text {
  text-align: center;
  border: 1px solid #ccc;
  padding: 10px;
  min-width: 80px;
}

.logo-title {
  font-size: 12px;
  font-weight: bold;
}

.logo-subtitle,
.logo-quality {
  font-size: 10px;
}

.logo-brand {
  font-size: 14px;
  font-weight: bold;
  color: #0066cc;
}

.title-section {
  flex: 1;
  text-align: center;
}

.title-section h1 {
  font-size: 20px;
  font-weight: bold;
  margin: 0;
}

.info-section {
  text-align: right;
  font-size: 10px;
  line-height: 1.4;
  flex-shrink: 0;
}

.date-field {
  text-align: right;
  margin-bottom: 20px;
  font-size: 12px;
}

/* Table Styles */
.table-container {
  overflow-x: auto;
  margin-bottom: 30px;
}

.maintenance-table {
  width: 100%;
  border-collapse: collapse;
  font-size: 11px;
}

.maintenance-table th,
.maintenance-table td {
  border: 1px solid #666;
  padding: 4px;
  text-align: center;
}

.table-header {
  background-color: #f0f0f0;
}

.table-header th {
  font-weight: bold;
  padding: 8px 4px;
}

.maintenance-table td {
  height: 25px;
  min-width: 30px;
}

.equipment-info {
  text-align: left;
  padding-left: 8px;
}

.maintenance-type {
  font-weight: bold;
  background-color: #f9f9f9;
}

td {
  text-transform: uppercase;
}

/* Color Classes */
.cell-blue {
  background-color: #3b82f6 !important;
}

.cell-green {
  background-color: #10b981 !important;
}

.cell-white {
  background-color: white;
}

/* Footer Styles */
.footer-section {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  gap: 40px;
}

.legend {
  flex: 1;
}

.legend-definitions {
  margin-bottom: 15px;
}

.legend-item {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-bottom: 4px;
  font-size: 11px;
}

.legend-label {
  font-weight: bold;
  min-width: 25px;
}

.color-legend {
  display: flex;
  gap: 20px;
}

.color-item {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 11px;
}

.color-box {
  width: 16px;
  height: 16px;
  border: 1px solid #666;
}

.color-box.programado {
  background-color: #10b981;
}

.color-box.realizado {
  background-color: #3b82f6;
}

/* Signature Styles */
.signature-section {
  display: flex;
  gap: 40px;
}

.signature-box {
  text-align: center;
  min-width: 150px;
}

.signature-image {
  border: 1px solid #666;
  width: 130px;
  height: 70px;
  margin-bottom: 8px;
  display: flex;
  align-items: center;
  justify-content: center;
  background-color: #fafafa;
}

.signature-img {
  max-width: 100%;
  max-height: 100%;
  object-fit: contain;
}

.signature-title {
  font-size: 11px;
  font-weight: bold;
  margin-bottom: 15px;
}

.signature-label {
  font-size: 10px;
}

/* Responsive */
@media (max-width: 1200px) {
  .header {
    flex-direction: column;
    text-align: center;
  }

  .footer-section {
    flex-direction: column;
    gap: 20px;
  }

  .signature-section {
    justify-content: center;
  }
}

@media (max-width: 768px) {
  .container {
    padding: 10px;
  }

  .maintenance-table {
    font-size: 9px;
  }

  .maintenance-table th,
  .maintenance-table td {
    padding: 2px;
  }
}

</style>

<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="logo-section">
                <div class="logo-text">
                    <img src="../img/Quality-BOLCA.png" style="max-width: 100px" alt="" srcset="">
                </div>
            </div>

            <div class="title-section">
                <h1>PROGRAMA DE MANTENIMIENTO DE EQUIPO DE CÓMPUTO</h1>
            </div>

            <div class="info-section">
                <div>Código: QB-FI-A-06</div>
                <div>Rev.03</div>
                <div>Fecha de emisión: 19-01-2012</div>
                <div>Fecha de revisión: 01-03-2023</div>
            </div>
        </div>

        <!-- Date field -->
        <div class="date-field">
            <p>Fecha de actualización: <span id="fechaactualizacion" style="text-decoration: underline;"></span></p>
        </div>

        <!-- Main Table -->
        <div class="table-container">
            <table id="maintenanceTable" class="maintenance-table">
                <thead>
                    <tr class="table-header">
                        <th>ID DE EQUIPO</th>
                        <th>NOMBRE DEL USUARIO</th>
                        <th>MARCA</th>
                        <th>DEPARTAMENTO</th>
                        <th>REGIÓN</th>
                        <th>FECHA DE COMPRA</th>
                        <th colspan="2">TÉCNICO RESPONSABLE</th>
                        <th>ENE</th>
                        <th>FEB</th>
                        <th>MAR</th>
                        <th>ABR</th>
                        <th>MAY</th>
                        <th>JUN</th>
                        <th>JUL</th>
                        <th>AGO</th>
                        <th>SEP</th>
                        <th>OCT</th>
                        <th>NOV</th>
                        <th>DIC</th>
                    </tr>
                </thead>
                <tbody id="tableBody">
                    <!-- Content will be generated by JavaScript -->
                </tbody>
            </table>
        </div>

        <!-- Legend and Footer -->
        <div class="footer-section">
            <div class="legend">
                <div class="legend-definitions">
                    <div class="legend-item">
                        <span class="legend-label">HP:</span>
                        <span>Hardware programado</span>
                    </div>
                    <div class="legend-item">
                        <span class="legend-label">HR:</span>
                        <span>Hardware realizado</span>
                    </div>
                    <div class="legend-item">
                        <span class="legend-label">SP:</span>
                        <span>Software programado</span>
                    </div>
                    <div class="legend-item">
                        <span class="legend-label">SR:</span>
                        <span>Software realizado</span>
                    </div>
                </div>
                <div class="color-legend">
                    <div class="color-item">
                        <div class="color-box programado"></div>
                        <span>Programado</span>
                    </div>
                    <div class="color-item">
                        <div class="color-box realizado"></div>
                        <span>Realizado</span>
                    </div>
                </div>
            </div>

            <div class="signature-section">
                <div class="signature-box">
                    <div class="signature-image">
                        <img src="../firmas/618818.webp" alt="Firma Elaboró" class="signature-img">
                    </div>
                    <div class="signature-title">ELABORÓ</div>
                    <div class="signature-label">FIRMA</div>
                </div>
                <div class="signature-box">
                    <div class="signature-image">
                        <img src="../firmas/1is6oik6m821459060498007.webp" alt="Firma Revisó y Aprobó" class="signature-img">
                    </div>
                    <div class="signature-title">REVISÓ Y APROBÓ</div>
                    <div class="signature-label">FIRMA</div>
                </div>
            </div>
        </div>
    </div>

</body>

<script>
  // Datos de ejemplo
const equipmentData = <%- JSON.stringify(programaResultados) %>;


const months = ["ENE", "FEB", "MAR", "ABR", "MAY", "JUN", "JUL", "AGO", "SEP", "OCT", "NOV", "DIC"]
const maintenanceTypes = [
  { key: "HP", name: "HP" },
  { key: "HR", name: "HR" },
  { key: "SP", name: "SP" },
  { key: "SR", name: "SR" },
]

// Función para determinar el color de la celda
function getCellColor(equipment, maintenanceType, month) {
  const { ultimoMantenimiento } = equipment

  let nuevaFecha = new Date(ultimoMantenimiento)
  let mes = nuevaFecha.getMonth() + 1
  let año = nuevaFecha.getFullYear()
  let añoactual = new Date().getFullYear()

  console.log(año, añoactual);

  // Lógica para HP y SP (Hardware/Software programado) - siempre azul en JUN y DIC
  if (maintenanceType === "HP" || maintenanceType === "SP") {
    if (month === "JUN" || month === "DIC") {
      return "cell-blue"
    }
  }

  // Lógica para HR y SR (Hardware/Software realizado) - verde según ultimoMantenimiento
  if (maintenanceType === "HR" || maintenanceType === "SR") {
    if (mes === 6 && month === "JUN") {
      return "cell-green"
    }
    if (mes === 12 && año === añoactual) {
      if (month === "JUN" || month === "DIC") {
        return "cell-green"
      }
    }
  }

  return "cell-white"
}

// Función para generar la tabla
function generateTable() {
  const tableBody = document.getElementById("tableBody")
  tableBody.innerHTML = ""

  equipmentData.forEach((equipment, equipmentIndex) => {
    maintenanceTypes.forEach((maintenanceType, typeIndex) => {
      const row = document.createElement("tr")



      // Si es la primera fila del equipo, agregar las celdas con información del equipo
      if (typeIndex === 0) {
        const equipmentCells = [
          equipment.idInventario,
          equipment.nombrelargo,
          equipment.marca,
          equipment.usoExclusivo,
          equipment.region,
          equipment.fechaCompra,
          equipment.tecnicoresponsable = 'Oscar De luna',
        ]

        equipmentCells.forEach((cellData, cellIndex) => {
          const cell = document.createElement("td")
          cell.textContent = cellData
          cell.rowSpan = 4
          if (cellIndex === 1 || cellIndex === 6) {
            // Nombre de usuario y técnico responsable
            cell.classList.add("equipment-info")
          }
          row.appendChild(cell)
        })
      }

      // Celda del tipo de mantenimiento
      const typeCell = document.createElement("td")
      typeCell.textContent = maintenanceType.name
      typeCell.classList.add("maintenance-type")
      row.appendChild(typeCell)

      // Celdas de los meses
      months.forEach((month) => {
        const monthCell = document.createElement("td")
        const colorClass = getCellColor(equipment, maintenanceType.key, month)
        monthCell.classList.add(colorClass)
        row.appendChild(monthCell)
      })

      tableBody.appendChild(row)
    })
  })

  const fechaactualizacion = document.getElementById("fechaactualizacion")
  fechaactualizacion.textContent = equipmentData[equipmentData.length - 1].fechaCompra
}

// Función para cargar datos desde JSON (opcional)
function loadDataFromJSON(jsonData) {
  if (Array.isArray(jsonData)) {
    equipmentData.length = 0 // Limpiar datos existentes
    equipmentData.push(...jsonData)
    generateTable()
  }
}

// Inicializar la tabla cuando se carga la página
document.addEventListener("DOMContentLoaded", () => {
  generateTable()
})

// Función global para actualizar datos (puede ser llamada desde fuera)
window.updateMaintenanceData = (newData) => {
  loadDataFromJSON(newData)
}

</script>
</html>
