<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sistema de Tickets IT - Crear Ticket</title>
    <!-- Changed to use index.css instead of styles.css -->
    <link rel="stylesheet" href="/styles/sistemas/estilos_levantamiento_tickets.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>

<body>
    <div class="container">
        <header class="header">
            <div class="header-content">
                <h1>Sistema de Tickets IT</h1>
                <nav>
                    <!-- <a href="index.html" class="nav-link active">Crear Ticket</a> -->
                    <a href="misTickets" class="nav-link active">mis Tickets</a>
                </nav>
            </div>
        </header>

        <main class="main-content">
            <div class="form-container">
                <div class="form-header">
                    <h2>Crear Nuevo Ticket</h2>
                    <p>Complete el formulario para reportar un problema técnico</p>
                </div>
                <input type="hidden" id="csrfToken" value="<%= csrfToken %>">
                <form id="ticketForm" class="ticket-form">
                    <div class="form-group">
                        <label>Nombre del Usuario *</label>
                        <input type="text" id="nombreUsuario" name="nombreUsuario" value="<%= info.nombreCompleto %>"
                            disabled>
                        <span class="error-message" id="nombreUsuarioError"></span>
                    </div>

                    <div class="form-group">
                        <label>Departamento *</label>
                        <input type="text" id="departamento" name="departamento" value="<%= info.departamento %>"
                            disabled>
                        <span class="error-message" id="departamentoError"></span>
                    </div>

                    <div class="form-group">
                        <label for="title">Título del Problema *</label>
                        <input type="text" id="titulo" name="titulo" required placeholder="Ej: Computadora no enciende">
                        <span class="error-message" id="tituloError"></span>
                    </div>

                    <div class="form-group">
                        <label for="category">Categoría *</label>
                        <select id="categoria" name="categoria" required>
                            <option value="">Seleccione una categoría</option>
                            <option value="hardware">Hardware</option>
                            <option value="software">Software</option>
                            <option value="network">Red/Conectividad</option>
                            <option value="printer">Impresoras</option>
                            <option value="email">Correo Electrónico</option>
                            <option value="other">Otro</option>
                        </select>
                        <span class="error-message" id="categoriaError"></span>
                    </div>

                    <!-- Evaluación del ticket: unico afectado -->
                    <div class="form-group">
                        <label for="affected">Numero de personas afectadas *</label>
                        <select id="numAfectacion" name="numAfectacion" required>
                            <option value="">Seleccione un número</option>
                            <option value="1">1 (solo yo)</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5 o más</option>
                        </select>
                        <span class="error-message" id="numAfectacionError"></span>
                    </div>

                    <!-- Evaluación del ticket: porcentaje de impacto al trabajo -->
                    <div class="form-group">
                        <label for="percentage">En que porcentaje afecta mi trabajo? *</label>
                        <select id="porcentaje" name="porcentaje" required>
                            <option value="">Seleccione un porcentaje</option>
                            <option value="1">0 - 30%</option>
                            <option value="2">30% - 50%</option>
                            <option value="3">50% - 90%</option>
                            <option value="4">90% - 100%</option>
                        </select>
                        <span class="error-message" id="porcentajeError"></span>
                    </div>

                    <!-- Evaluación del ticket: cantidad de procesos afectados -->
                    <div class="form-group">
                        <label for="process-affected">Cantidad de procesos afectados *</label>
                        <select id="procesos" name="procesos" required>
                            <option value="">Seleccione un número</option>
                            <option value="1">1</option>
                            <option value="4">2 o más</option>
                        </select>
                        <span class="error-message" id="procesosError"></span>
                    </div>

                    <div class="form-group">
                        <label for="priority">Prioridad *</label>
                        <select id="prioridad" name="prioridad" required>
                            <option value="">Prioridad</option>
                            <option value="low">Baja - Puede esperar</option>
                            <option value="medium">Media - Importante</option>
                            <option value="high">Alta - Urgente</option>
                            <option value="critical">Crítica - Bloquea trabajo</option>
                        </select>
                        <span class="error-message" id="prioridadError"></span>
                    </div>

                    <div class="form-group">
                        <label for="description">Descripción del Problema *</label>
                        <textarea id="descripcion" name="descripcion" rows="5" required
                            placeholder="Describa detalladamente el problema que está experimentando..."></textarea>
                        <span class="error-message" id="descripcionError"></span>
                    </div>

                    <div class="form-actions">
                        <button type="button" class="btn btn-primary" id="btnEnvio">
                            <span class="btn-text">Enviar Ticket</span>
                        </button>
                        <button type="reset" class="btn btn-secondary">
                            Limpiar Formulario
                        </button>
                    </div>
                </form>

                <div id="successMessage" class="success-message" style="display: none;">
                    <div class="success-content">
                        <svg class="success-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>
                            <polyline points="22 4 12 14.01 9 11.01"></polyline>
                        </svg>
                        <h3>¡Ticket Creado Exitosamente!</h3>
                        <p>Su ticket ha sido registrado. Número de ticket: <strong id="ticketNumber"></strong></p>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <!-- Changed to use index.js instead of app.js -->
    <script>
        const tok = "<%= csrfToken %>";
    </script>
    <script src="/scripts/sistemas/scripts_levantamiento_tickets.js"></script>
    <script src="/scripts/calidad/funcion_fetch_calidad.js"></script>
</body>

</html>